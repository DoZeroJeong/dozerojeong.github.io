---
layout: post
title: Oracle Databbase 11g Process Architecture
---

오라클 데이터베이스의 프로세슨느 클라이언트(사용자) 프로세스 + 서버 프로세스 + 백그라운드 프로세스의 조합으로 구성된다.

- 클라이언트 프로세스
    - 웹 애플리케이션, 데스크톱 애플리케이션 등 오라클 데이터베이스와 통신하는 사용자 응용 프로그램을 말한다.

- 서버 프로세스
    - 클라이언트 프로세스가 보낸 요청을 처리한다. 디스크로부터 블록을 읽어들여 DBC에 기록하거나, 반대로 디스크에 블록을 내보내기도 한다.

- 백그라운드 프로세스
    - 오라클 데이터베이스를 지속적으로 수행하는데 필요한 일상적인 작업을 담당한다.

## 백그라운드 프로세스 종류

- DBWn(Database Writer Process)
    - 데이터베이스 버퍼 캐시에 변경이 가해질 때마다 수정된 버퍼(더티 버퍼)를 디스크에 기록하여 실제 파일에 반영되도록 한다.
    - 변경이 가해지는 즉시 DBWn이 동작하는 것은 아니다.
        - 디스크 I/O 작업이 빈번하게 일어나면 데이터베이스 전체의 성능이 저하될 우려가 있기 때문이다.
    - 지연 쓰기를 통해 일정한 간격을 두고 디스크 기록을 수행한다.

- CKPT(Checkpoint Process)
    - 일정 시점마다 DBWn와 LGWR 프로세스에 신호(Check Point)를 주어, DBC와 Redo 로그 버퍼에 저장된 내용이 디스크에 있는 파일에 반영되는 것을 보장한다.

Check Point 발생시키는 시점은 다음과 같다.

1. 마지막 체크포인트 이후 정해진 시간(초 단위)이 지났을 때
2. 데이터베이스 인스턴스가 종료될 때
3. 테이블스페이스가 오프라인으로 바뀌거나 백업이 시작될 때

- LGWR(Log Write Process)
    - Redo 로그 버퍼의 내용을 디스크에 있는 Online Redo Log 파일로 기록하는 역할을 담당한다.

LGWR이 파일 기록을 수행하는 시점은 다음과 같다.

1. 클라이언트 프로세스가 트랜잭션을 명령할 때
2. Redo 로그 버퍼가 1/3 가량 찼을 때
3. 마지막 기록 시점으로부터 3초가 지났을 때

Redo 로그 버퍼는 로그 손실을 막기 위해 여러 개의 그룹으로 로그를 복사하여 순환 형식으로 관리된다. 모든 그룹이 손상될 경우, 오라클 데이터베이스는 작동을 멈춘다.

- ARCn(Archiver Process)
    - 온라인 Redo 로그파일을 백업해주는 프로세스이다. 파일의 최대 용량까지 로그가 꽉 찼을 경우 로그 스위치가 발동하고, 이 때 ARCn에 의해 온라인 Redo 로그파일의 내용이 Archive Redo 로그파일로 복사된다.

- RVWR(Recovery Writer Process)
    - 오라클 데이터베이스 10g부터 새롭게 도입된 프로세스이며 플래시백 데이터베이스 기능을 관리하기 위해 사용된다.

- PMON(Process Monitor)
    - 각 서버 프로세스들을 감시하는 또 하나의 프로세스로 클라이언트 프로세스가 작동에 실패했을때 리소스를 해제하거나, 서버 프로세스가 비정상 종료되었을 경우 메모리를 정리하는 등의 일을 맡는다.
    - 약 1분에 한 번씩 실행되며, DBWn이나 LGWR 같은 중요한 백그라운드 프로세스가 종료되었을 시 PMON은 데이터베이스 인스턴스 전체를 강제 종류시켜 추가적인 실행을 막는다.

- SMON(System Monitor)
    - 오라클 데이터베이스의 전체 인스턴스를 관리한다.
    - 인스턴스 충돌 또는 실패(Crash / Fail)가 발생한 후 인스턴스를 초기화 해주고, 비정상적으로 종료된 트랜잭셕이 있다면 복원해 준다.

- RECO(Recover Process)
    - 분산 데이터베이스에서 시스템 장애나 오류가 발생했을 경우 해당 트랜잭션을 복원시키는 역할을 수행한다.

- MMON(Memory Monitor Process)
    - 오라클 데이터베이스 10g부터 추가됐으며, AWR의 오류 진단 및 자가튜닝을 수행한다.
        - AWR(Automatic Workload Repository)
            - 데이터베이스에 대한 성능 자료를 수집하여 스냅샷으로 만들고, 이를 일정 기간 보관하는 공간이다.

- MMNL(Memory Monitor Light Process)
    - ASH 정보를 디스크에 파일로 내보내는 역할을 한다.
        - ASH(Active Session History)
            - 오라클 데이터베이스는 현재 활성화된 세션의 정보를 1초 간격으로 수집하여 SGA 내의 공유 풀에 기록한다.

